http://www.assembla.com/code/bniEmC9p0r3P96eJe5aVNr/subversion/nodes/GmailHelper?rev=11